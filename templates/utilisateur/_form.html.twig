{{ form_start(form, {'attr': {'class': 'needs-validation', 'novalidate': ''}}) }}
    <div class="my-3">
        {{ form_errors(form) }}
    </div>

    <div class="row">
        <div class="col-md-6 mb-3">
            {{ form_row(form.email, {
                'label': 'Adresse e-mail',
                'label_attr': {'class': 'form-label'},
                'attr': {'class': 'form-control form-control-lg'}
            }) }}
        </div>
        <div class="col-md-6 mb-3">
            {{ form_row(form.nom_complet, {
                'label': 'Nom complet (optionnel)',
                'label_attr': {'class': 'form-label'},
                'attr': {'class': 'form-control form-control-lg'}
            }) }}
        </div>
    </div>

    <div class="mb-4">
        {{ form_row(form.roles, {
            'label': 'Rôles de l\'utilisateur', 
            'label_attr': {'class': 'form-label fw-bold'}
        }) }}
    </div>
    
    <fieldset class="mb-3 p-3 border rounded">
        <legend class="w-auto px-2 h5" style="color: var(--bleu-majorelle);">Mot de passe</legend>
        {% if form.vars.data.id is not null and (form.plainPassword.first.vars.data is empty or form.plainPassword.first.vars.data is null) and (form.plainPassword.second.vars.data is empty or form.plainPassword.second.vars.data is null) %}
            <p class="form-text text-muted small">Laissez les champs "Mot de passe" vides si vous ne souhaitez pas le modifier.</p>
        {% elseif form.vars.data.id is null %}
             <p class="form-text text-muted small">Le mot de passe est requis pour un nouvel utilisateur (minimum 6 caractères).</p>
        {% endif %}
        
        <div class="mb-3">
            {{ form_row(form.plainPassword.first, {
                'label': 'Mot de passe' ~ (form.vars.data.id is null ? '' : ' (laisser vide pour ne pas changer)'),
                'label_attr': {'class': 'form-label'},
                'attr': {'class': 'form-control-lg'}
            }) }}
        </div>
        <div class="mb-3">
            {{ form_row(form.plainPassword.second, {
                'label': 'Répéter le mot de passe',
                'label_attr': {'class': 'form-label'},
                'attr': {'class': 'form-control-lg'}
            }) }}
        </div>
    </fieldset>

    <button class="btn btn-lg mt-3" style="background-color: var(--bleu-majorelle); border-color: var(--bleu-majorelle); color: white;">{{ button_label|default('Enregistrer') }}</button>
{{ form_end(form) }}
