{% extends 'base.html.twig' %}

{% block title %}Liste des Tickets - Service Support{% endblock %}

{% block body %}
<style>
    .container-ticket-list { max-width: 1200px; margin: 2em auto; padding: 20px; background-color: #fff; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.05); }
    .ticket-list-header h1 { color: #333; border-bottom: 2px solid #eee; padding-bottom: 0.5em; margin-bottom: 1em; }
    .table-tickets { width: 100%; border-collapse: collapse; margin-top: 1em; }
    .table-tickets th, .table-tickets td { border: 1px solid #ddd; padding: 10px; text-align: left; }
    .table-tickets th { background-color: #f8f9fa; font-weight: bold; }
    .table-tickets tbody tr:nth-child(odd) { background-color: #f9f9f9; }
    .table-tickets tbody tr:hover { background-color: #f1f1f1; }
    .no-tickets { padding: 20px; text-align: center; color: #777; font-style: italic; }
    .description-short { max-width: 300px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; }
</style>

<div class="container-ticket-list">
    <div class="ticket-list-header">
        <h1>Liste des Tickets Clients</h1>
    </div>

    {% if tickets is not empty %}
        <table class="table-tickets">
            <thead>
                <tr>
                    <th>ID</th>
                    <th>Auteur (Email)</th>
                    <th>Date Ouverture</th>
                    <th>Catégorie</th>
                    <th>Statut</th>
                    <th>Description (extrait)</th>
                </tr>
            </thead>
            <tbody>
            {% for ticket in tickets %}
                <tr>
                    <td>{{ ticket.id }}</td>
                    <td>{{ ticket.auteurEmail }}</td>
                    <td>{{ ticket.dateOuverture ? ticket.dateOuverture|date('d/m/Y H:i') : '' }}</td>
                    <td>{{ ticket.categorie ? ticket.categorie.nom : 'N/A' }}</td>
                    <td>{{ ticket.statut ? ticket.statut.nom : 'N/A' }}</td>
                    <td class="description-short" title="{{ ticket.description }}">{{ ticket.description|slice(0, 50) }}{% if ticket.description|length > 50 %}...{% endif %}</td>
                </tr>
            {% endfor %}
            </tbody>
        </table>
    {% else %}
        <p class="no-tickets">Aucun ticket trouvé pour le moment.</p>
    {% endif %}

</div>
{% endblock %}
